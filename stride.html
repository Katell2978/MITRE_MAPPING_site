<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>STRIDE → CWE Mapping (EMB3D)</title>

  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 2rem;
      background: #f8f9fa;
    }
    h1 { color: #222; }

    select, button {
      padding: 8px;
      font-size: 1rem;
      margin-right: 8px;
    }

    .card {
      background: #fff;
      padding: 1rem;
      margin: 1rem 0;
      border-left: 5px solid #0078d4;
      box-shadow: 0 2px 4px rgba(0,0,0,.1);
    }

    ul { margin-top: 0.5rem; }
    li { margin-bottom: 0.4rem; }
  </style>
</head>

<body>

<h1>STRIDE → CWE Mapping (MITRE EMB3D)</h1>

<p>
Sélectionne un <strong>STRIDE</strong> pour afficher les <strong>CWE associées</strong>.
</p>

<select id="strideSelect">
  <option value="">-- Choisir un STRIDE --</option>
  <option value="Spoofing">Spoofing</option>
  <option value="Tampering">Tampering</option>
  <option value="Repudiation">Repudiation</option>
  <option value="Information Disclosure">Information Disclosure</option>
  <option value="Denial of Service">Denial of Service</option>
  <option value="Elevation of Privilege">Elevation of Privilege</option>
</select>

<button onclick="searchByStride()">Afficher</button>

<div id="results"></div>

<!-- ✅ CHARGEMENT CORRECT DES DONNÉES -->
<script src="data/data.js"></script>

<!-- ✅ LOGIQUE DE RECHERCHE -->
<script>
function searchByStride() {
  const selectedStride = document.getElementById("strideSelect").value;
  const results = document.getElementById("results");
  results.innerHTML = "";

  if (!selectedStride) {
    results.innerHTML = "<p>Veuillez sélectionner un STRIDE.</p>";
    return;
  }

  const matchingCWEs = Object.entries(CWE_DATA)
    .filter(([_, data]) => data.stride.includes(selectedStride));

  if (matchingCWEs.length === 0) {
    results.innerHTML = "<p>Aucune CWE trouvée pour ce STRIDE.</p>";
    return;
  }

  const cweList = matchingCWEs.map(([cwe, data]) => `
    <li>
      <strong>${cwe}</strong> —
      <a href="${data.lien}" target="_blank">Lien MITRE</a>
    </li>
  `).join("");

  results.innerHTML = `
    <div class="card">
      <h3>STRIDE : ${selectedStride}</h3>
      <p><strong>CWE associées :</strong></p>
      <ul>
        ${cweList}
      </ul>
    </div>
  `;
}
</script>

</body>
</html>
