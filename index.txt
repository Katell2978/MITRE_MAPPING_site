DOC Technique pour comprendre le mode de focntionnement de la page index.html

Index.html est une page web  (HTML + CSS + JavaScript pur) qui fonctionne **entiÃ¨rement cÃ´tÃ© navigateur**.
Elle implÃ©mente un **pipeline dâ€™analyse de vulnÃ©rabilitÃ©** :
    EntrÃ©e utilisateur
       â”‚
       â”œâ”€ Recherche CVE (ou CPE)
       â”‚
       â”œâ”€ NVD API (CVE / CPE)
       â”‚
       â”œâ”€ Extraction CWE
       â”‚
       â”œâ”€ Mapping CWE â†’ CAPEC (local)
       â”‚
       â”œâ”€ Mapping CAPEC â†’ ATT&CK (local)
       â”‚
       â”œâ”€ Mapping ATT&CK â†’ ATM (CSV)
       â”‚
       â”œâ”€ DÃ©tection (DET / DC / onboard / offboard)
       â”‚
       â””â”€ Visualisation (texte + graphe SVG)

ğŸ‘‰ **Aucun backend**, aucun stockage serveur.\

# 2ï¸âƒ£ Organisation des zones HTML (DIV) et leur rÃ´le
## ğŸ§­ 2.1 Structure principale
### `<header>`
*   PrÃ©sentation de lâ€™outil
*   Contexte fonctionnel (ce que fait la page)
*   PrÃ©-requis de donnÃ©es
***
### `<main>`
Contient **tout le flux interactif**.
***
## ğŸ§© 2.2 Bloc de recherche (contrÃ´le utilisateur)
### RÃ´le des Ã©lÃ©ments :
| Ã‰lÃ©ment       | RÃ´le                                                         |
| ------------- | ------------------------------------------------------------ |
| `#mode`       | SÃ©lection du **type de recherche** (CVE ou CPE)              |
| `#queryInput` | Saisie libre de lâ€™identifiant                                |
| `#searchBtn`  | DÃ©clenche la recherche                                       |
| `#status`     | Feedback utilisateur (Ã©tat, erreurs, filtrage 12 mois, etc.) |

ğŸ‘‰ **Aucune logique mÃ©tier ici**, seulement des **dÃ©clencheurs**.
***
## ğŸ“¦ 2.3 Zone de rÃ©sultats principale
### RÃ´le
Câ€™est le **conteneur dynamique principal**.\
Il est **entiÃ¨rement reconstruit** Ã  chaque recherche.
Il peut contenir :
*   soit une **liste de CVE** (mode CPE)
*   soit une **vue dÃ©taillÃ©e CVE** (mode CVE)
ğŸ‘‰ Cela Ã©vite la complexitÃ© dâ€™un DOM partiellement mis Ã  jour.
***
## ğŸ”¬ 2.4 Vue dÃ©taillÃ©e CVE (injectÃ©e dynamiquement)
CrÃ©Ã©e par la fonction `renderCveDetail()`.
### Sous-blocs importants :
#### âœ… Informations CVE
*   Description
*   Dates
*   Liens NVD / EUVD
*   CVSS (toutes versions supportÃ©es)
*   CPE impactÃ©s
ğŸ‘‰ Source : **NVD uniquement**
***
#### âœ… Liste des CWE
Chaque CWE devient un **pivot interactif** :
*   lien MITRE CWE (documentation)
*   bouton `â†³` = **dÃ©clenchement du drilldown**
***
#### âœ… Bloc Drilldown
Câ€™est **le cÅ“ur analytique**.
Il est vide par dÃ©faut, puis rempli aprÃ¨s clic sur une CWE.
***
# 3ï¸âƒ£ Fonctions JavaScript â€” rÃ´le et responsabilitÃ©
## ğŸ§± 3.1 Fonctions utilitaires (fondation)
### `escapeHtml()`
*   EmpÃªche toute injection HTML
*   SÃ©curise les contenus dynamiques
### `log()`
*   Ã‰crit dans le **moniteur dâ€™activitÃ©**
*   Sert de **trace dâ€™exÃ©cution**
### `setStatus()`
*   Met Ã  jour lâ€™Ã©tat utilisateur (chargement, erreur, filtrage)
***
## ğŸ” 3.2 Fonctions de recherche (entrÃ©e du pipeline)
### `search()`
**Point dâ€™entrÃ©e principal**\
DÃ©cide :
*   CVE â†’ `searchCve()`
*   CPE â†’ `searchCpe()`
***
### `searchCve(cveId)`
**ResponsabilitÃ© :**
*   Valider le format CVE
*   Interroger NVD (`?cveId=`)
*   Afficher le dÃ©tail CVE
ğŸ‘‰ **Une seule CVE, un seul objet**, pas de pagination.
***
### `searchCpe(cpe)`
**ResponsabilitÃ© :**
1.  Validation du format CPE
2.  **Sondage du volume NVD**
3.  Si trop de rÃ©sultats :
    *   appliquer automatiquement un **filtre temporel 12 mois**
4.  Afficher une **liste de CVE cliquables**
ğŸ‘‰ Câ€™est volontairement **une vue dâ€™exploration**, pas une vue exhaustive.
***
## ğŸ§  3.3 Chargement des bases locales
### `loadSecurityBases()`
Charge **une seule fois** :
*   `cwe_db.json`
*   `capec_db.json`
*   `techniques_db.json`
ğŸ‘‰ Ces fichiers sont **tes tables de correspondance**.
***
### `loadATM()`
Charge et parse :
*   `ATM-matrix-TTP.csv`
Produit une structure exploitable :
```js
{
  tactic,
  atmId,
  label,
  mitreEnt[],
  mitreMob[],
  det[],
  dc[],
  onboard,
  offboard,
  rmq
}
```
ğŸ‘‰ Câ€™est ton **rÃ©fÃ©rentiel mÃ©tier automotive**.
***
## ğŸ”— 3.4 ChaÃ®nage sÃ©mantique (le cÅ“ur du moteur)
### `computeCapecAndTechniquesFromCWE(cweId)`
Pipeline interne :
    CWE
     â””â”€ RelatedAttackPatterns[]
          â””â”€ CAPEC
               â””â”€ taxonomy
                    â””â”€ ATT&CK techniques (Txxxx)

Retourne :

*   Liste de CAPEC
*   Liste **dÃ©duite** de techniques ATT\&CK
ğŸ‘‰ **Aucune hypothÃ¨se**, tout est issu des donnÃ©es MITRE.
***
### `matchATMByTechniques(techniques, atmRows)`
**Jointure mÃ©tier** :
    ATT&CK Txxxx
       â””â”€ ATM-matrix-TTP.csv
            â””â”€ ATM-Txxxx
Permet de rÃ©pondre Ã  :
> *â€œQuels scÃ©narios ATM sont concernÃ©s par ces techniques ?â€*
***
## ğŸ§ª 3.5 Drilldown (analyse approfondie)
### `renderDrilldown(cveId, cweId)`
Câ€™est la **fonction clÃ©**.
Elle :
1.  Calcule CAPEC + ATT\&CK
2.  Joint avec ATM
3.  Affiche :
    *   CAPEC
    *   ATT\&CK
    *   ATM + dÃ©tection
4.  GÃ©nÃ¨re le **visuel SVG**
***

# 4ï¸âƒ£ Le visuel SVG : rÃ´le et logique
## ğŸ¨ Objectif
Montrer **les pivots et les liens**, pas un graphe dÃ©coratif.
    CWE â†’ CAPEC â†’ ATT&CK â†’ ATM â†’ DET / DC
***
## ğŸ§© Ã‰lÃ©ment HTML
### Pourquoi SVG ?
*   Natif navigateur
*   Exportable
*   Lisible
*   Pas de dÃ©pendance externe
***
## ğŸ§  Fonction `renderPivotGraph()`
Elle :
*   CrÃ©e des **colonnes logiques**
*   Place des **nÅ“uds**
*   Trace des **liens courbes**
*   Tronque intelligemment pour lisibilitÃ©
ğŸ‘‰ Le graphe **reflÃ¨te exactement les donnÃ©es calculÃ©es**, rien de plus.
***
# 5ï¸âƒ£ Moniteur dâ€™activitÃ©
### RÃ´le
*   Debug
*   ComprÃ©hension du flux
*   TraÃ§abilitÃ© analyste
Exemples :
*   Filtrage 12 mois appliquÃ©
*   Volume CPE
*   Nombre de CAPEC / ATT\&CK / ATM trouvÃ©s
***
# 6ï¸âƒ£ Philosophie gÃ©nÃ©rale du code
âœ… **SÃ©paration claire des responsabilitÃ©s**\
âœ… **Aucune magie cachÃ©e**\
âœ… **Tout est dÃ©terministe et traÃ§able**\
âœ… **PensÃ© pour lâ€™analyse sÃ©curitÃ©**, pas pour le marketing
