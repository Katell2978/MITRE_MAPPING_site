<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>CWE → STRIDE Mapping (EMB3D)</title>

  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 2rem;
      background: #f8f9fa;
    }
    h1 { color: #222; }
    input { padding: 8px; width: 320px; }
    button { padding: 8px 12px; margin-left: 6px; }
    .card {
      background: #fff;
      padding: 1rem;
      margin: 1rem 0;
      border-left: 5px solid #0078d4;
      box-shadow: 0 2px 4px rgba(0,0,0,.1);
    }
    .stride { font-weight: bold; }
  </style>
</head>

<body>

<h1>CWE → STRIDE Mapping (MITRE EMB3D)</h1>

<p>
Recherche par <b>CWE</b> (ex: <code>CWE-1191</code>) ou par
<b>STRIDE</b> (ex: <code>Information Disclosure</code>)
</p>

<input id="searchInput" placeholder="CWE-1191 ou Information Disclosure">
<button onclick="search()">Rechercher</button>

<div id="results"></div>

<!-- ✅ Chargement des données -->
<script src="/data/data.js"></script>

<script>
function search() {
  const query = document.getElementById("searchInput").value.toLowerCase();
  const results = document.getElementById("results");
  results.innerHTML = "";

  if (!query) return;

  let found = false;

  Object.entries(CWE_DATA).forEach(([cwe, data]) => {
    const matchCWE = cwe.toLowerCase().includes(query);
    const matchStride = data.stride.some(s => s.toLowerCase().includes(query));

    if (matchCWE || matchStride) {
      found = true;
      results.innerHTML += `
        <div class="card">
          <h3>${cwe}</h3>
          <p class="stride">STRIDE : ${data.stride.join(", ")}</p>
          <p>
            <a href="${data.lien}" target="_blank">Lien CWE officiel</a>
          </p>
        </div>
      `;
    }
  });

  if (!found) {
    results.innerHTML = "<p>Aucun résultat trouvé.</p>";
  }
}
</script>

</body>
</html>
