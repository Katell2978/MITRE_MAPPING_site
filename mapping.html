<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>STRIDE / CWE / TID – ISO 21434</title>

  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 2rem;
      background: #f8f9fa;
    }
    h1 { color: #222; }
    select, input, button {
      padding: 8px;
      font-size: 1rem;
      margin-right: 6px;
    }
    .card {
      background: #fff;
      padding: 1rem;
      margin: 1rem 0;
      border-left: 5px solid #0078d4;
      box-shadow: 0 2px 4px rgba(0,0,0,.1);
    }
    .cwe {
      margin-top: 1rem;
    }
    .tags {
      font-size: 0.9em;
      color: #555;
    }
    ul { margin-top: 0.5rem; }
  </style>
</head>

<body>

<h1>Recherche STRIDE / CWE → TID (EMB3D – ISO 21434)</h1>

<p>
Recherche par :
</p>

<select id="strideSelect">
  <option value="">-- STRIDE --</option>
  <option>Spoofing</option>
  <option>Tampering</option>
  <option>Information Disclosure</option>
  <option>Denial of Service</option>
  <option>Elevation of Privilege</option>
</select>

<input id="cweInput" placeholder="CWE-1191">

<button onclick="search()">Rechercher</button>

<div id="results"></div>

<script>
/* =======================
   JSON COMPLET INTÉGRÉ
   ======================= */
const DATA = {
  "Spoofing": [
    {
      "cwe": "CWE-287",
      "cwe_description": "Improper Authentication.",
      "mitre_link": "https://cwe.mitre.org/data/definitions/287.html",
      "iso21434": {
        "security_properties": ["Authenticity"],
        "security_goals": ["SG-Auth"]
      },
      "tids": [
        {
          "tid": "TID-310",
          "tid_description": "Remote service accessible without authentication."
        },
        {
          "tid": "TID-328",
          "tid_description": "Hard-coded credentials enabling impersonation."
        }
      ]
    }
  ],

  "Tampering": [
    {
      "cwe": "CWE-1247",
      "cwe_description": "Improper Control of Hardware Security Features.",
      "mitre_link": "https://cwe.mitre.org/data/definitions/1247.html",
      "iso21434": {
        "security_properties": ["Integrity"],
        "security_goals": ["SG-Integrity", "SG-Platform"]
      },
      "tids": [
        {
          "tid": "TID-105",
          "tid_description": "Voltage or clock glitching to bypass security checks."
        }
      ]
    }
  ],

  "Information Disclosure": [
    {
      "cwe": "CWE-311",
      "cwe_description": "Missing Encryption of Sensitive Data.",
      "mitre_link": "https://cwe.mitre.org/data/definitions/311.html",
      "iso21434": {
        "security_properties": ["Confidentiality"],
        "security_goals": ["SG-Confidentiality"]
      },
      "tids": [
        {
          "tid": "TID-106",
          "tid_description": "Data bus interception."
        },
        {
          "tid": "TID-108",
          "tid_description": "Extraction of secrets from ROM or NVRAM."
        }
      ]
    }
  ],

  "Denial of Service": [
    {
      "cwe": "CWE-400",
      "cwe_description": "Uncontrolled Resource Consumption.",
      "mitre_link": "https://cwe.mitre.org/data/definitions/400.html",
      "iso21434": {
        "security_properties": ["Availability"],
        "security_goals": ["SG-Availability"]
      },
      "tids": [
        {
          "tid": "TID-401",
          "tid_description": "Flooding requests causing ECU resource exhaustion."
        }
      ]
    }
  ],

  "Elevation of Privilege": [
    {
      "cwe": "CWE-1191",
      "cwe_description": "Improper Access Control on Debug Interfaces.",
      "mitre_link": "https://cwe.mitre.org/data/definitions/1191.html",
      "iso21434": {
        "security_properties": ["Integrity", "Authenticity"],
        "security_goals": ["SG-Platform", "SG-Debug"]
      },
      "tids": [
        {
          "tid": "TID-115",
          "tid_description": "Unauthorized access via JTAG or SWD."
        },
        {
          "tid": "TID-119",
          "tid_description": "Latent debug port enabling code manipulation."
        }
      ]
    }
  ]
};

/* =======================
   LOGIQUE DE RECHERCHE
   ======================= */
function search() {
  const stride = document.getElementById("strideSelect").value;
  const cweSearch = document.getElementById("cweInput").value.toUpperCase();
  const results = document.getElementById("results");
  results.innerHTML = "";

  Object.entries(DATA).forEach(([strideKey, cwes]) => {
    if (stride && stride !== strideKey) return;

    cwes.forEach(entry => {
      if (cweSearch && !entry.cwe.includes(cweSearch)) return;

      const tids = entry.tids.map(t =>
        `<li><strong>${t.tid}</strong> — ${t.tid_description}</li>`
      ).join("");

      results.innerHTML += `
        <div class="card">
          <h3>${strideKey} – ${entry.cwe}</h3>
          <p>${entry.cwe_description}</p>
          <p>
